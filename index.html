<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lector de Medidores Gemini</title>
  <script>
    async function enviarImagen() {
      const input = document.getElementById("imageInput");
      const file = input.files[0];
      if (!file) {
        mostrarError("No se seleccionó ninguna imagen.");
        return;
      }

      const formData = new FormData();
      formData.append("file", file);

      try {
        const response = await fetch("https://lector-yaye.onrender.com/api/gemini-report", {
          method: "POST",
          body: formData
        });

        const data = await response.json();
        if (!response.ok) throw new Error(JSON.stringify(data));
        mostrarInforme(data);
      } catch (error) {
        mostrarError(error.message);
      }
    }

    function mostrarInforme(data) {
      document.getElementById("informe").innerHTML =
        "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
    }

    function mostrarError(mensaje) {
      document.getElementById("informe").innerHTML =
        "<div style='color:red;'><b>¡Error!</b> " + mensaje + "</div>";
    }
  </script>
</head>
<body style="font-family: sans-serif; background: #f6f0ff; padding: 2rem;">
  <h1 style="color: #7b2cbf;">Lector de Medidores Gemini</h1>

  <div style="margin-bottom: 2rem; padding: 1rem; background: white; border-radius: 1rem;">
    <h2>Paso 1: Sube o Captura Fotos del Medidor</h2>
    <input type="file" id="imageInput" accept="image/*"/>
  </div>

  <div style="margin-bottom: 2rem; padding: 1rem; background: white; border-radius: 1rem;">
    <h2>Paso 2: Generar Informe con Gemini</h2>
    <button onclick="enviarImagen()" style="padding: 0.5rem 1rem; background: #38b000; color: white; border: none; border-radius: 0.5rem;">Generar Informe</button>
  </div>

  <div id="informe" style="background: white; border-radius: 1rem; padding: 1rem;"></div>
</body>
</html>
